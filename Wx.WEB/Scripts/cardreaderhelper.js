var sourceWin = null;
var cardReader = null;

function setupEnv() {
    var wo = window.opener;
    if (wo == null) {
        sourceWin = window.parent.frames[0];
    }
    else {
        sourceWin = wo.parent.frames[0];
    }
    cardReader = sourceWin.cardReader;
}

setupEnv();


/** 读卡 
* 
* @param {txtCardNo} 卡号控件ID 
* @return {showErr} 是否显示错误信息，默认true
*/
var ReadCard = function (txtCardNo, showErr) {
    return ReadCardInfoImpl(txtCardNo != null ? arguments[0] : 'CardNo', cardReader.GetCardInfo, BindRequest, showErr);
};


var ReadCardNo = function (txtCardNo) {
    return ReadCardInfoImpl(txtCardNo != null ? arguments[0] : 'CardNo', cardReader.GetCardNo, BindRequest, true);
}
/** 售卡页面读二代证 
*  
* @return {showErr} 是否显示错误信息，默认true
*/
var ReadIDCard = function (showErr) {
    $('#hideIsReadIDCard').val('1');
    if (cardReader.testingMode) {
        idInfo = new $.wx.ocx.IDCardInfo('test',
       '1',
       '19901221',
       '南京市',
       '321281111111111',
       'FFD8FFE000104A46494600010101015E015E0000FFDB00430008050607060508070607090808090C130C0C0B0B0C1811120E131C181D1D1B181B1A1F232C251F212A211A1B2634272A2E2F3132311E25363A36303A2C303130FFDB0043010809090C0A0C170C0C1730201B203030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030FFC000110801B9016603012200021101031101FFC4001F0000010501010101010100000000000000000102030405060708090A0BFFC400B5100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FAFFC4001F0100030101010101010101010000000000000102030405060708090A0BFFC400B51100020102040403040705040400010277000102031104052131061241510761711322328108144291A1B1C109233352F0156272D10A162434E125F11718191A262728292A35363738393A434445464748494A535455565758595A636465666768696A737475767778797A82838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE2E3E4E5E6E7E8E9EAF2F3F4F5F6F7F8F9FAFFED0056FF227900010DD6D0B9FAC9F1B6DC41303137390AB0047C008C007000B4001200D3A9960001D1000000B1000000FD000000C500000078000000B2000000A4000000C60000001A4C001A010C00E800000000001F0DFFDA000C03010002110311003F00F7FA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A63B88D0B123804E3D7BD003E8AAAD7B02CEF133E1E31961E9C67F903F91A2E6EE382349890D1B02770E78C678FCA90AE8B54567DDEAB6B042ECD2A82A01C138241EE29936AB6D6F00777010805589F9718EE7A0C7539EDCD30BA34FA8E28AE3B4EF17DA1D4E2867B8897CE8559E32C328FDFF001CF51EF9ECD5A57FACC36D3AE245397F9A373CE785F948FF007852B93CEAD7371645625558120E08CF229A93231519DAC5776D3C1038EBF98AE6A1D621B89AFF00ECB32FEE55E4F303741C8EBE9CA3D25FEA735ADFC82165778A1926DA187299273EFCAAFE647A530E74752AC1802A4107A114EAC0F0EEB50DEDBC5183F3316083BF960B0563F5D86B7E8293BAB85145140C28A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A298EDB50B60B606703A9A007D30BA8EAC0738EBDFD2B9FD4BC576D62EAB7188033AC619D97AB038CAE4103200C9C7DE1EF8E6BC43E32B49CCF0DBC8D3889889638BFD6AA9DA0E10E33F7F919FE1EDC9A5721CD23B86D46DE2B992191C870CA36B0C633DC1EE3BFAFE95CC7893C5B6B105804B6F148EA424BE682C8E70A3006EFE26EFC7CADFDCE7CFB53F8810AB2DAEAB234F12BED8E586478D8AA3361BEF63F876FF0016D3F798D709E22D7A510B2FDAA6BB4DCA52597E57923FE1CFBFCBFF0001F9A8772399B3B1D6BC7179697F0CAB3DC46213B5A552A5947CDB37AFFC0B76DFF69BFD9DAED37E238B89ED56431C1721F1233B7EE1821253E63D3BFF0077AAFF0079ABC6EF755B91236276653B7682DB860741CFCD8AA22F586DC39C0F7C531389ED5ABF8EE55B611C57024F320982C5B94F94E372FCBF374F9BE5AC55F8932A582C303B6E2A8268DB94E3238FF65836DFF6BF8ABCC5EF252DBD65196EBCE0E6A38E50FB84A7071956CE3E6A07CA745FDB72C370924129C0395C1C6DE7E6F97FF1EF96BA8D1FE225E2AC70DDCBE64B1B1DACD2363046187F17F0FF00DF35E62EC166C93D3AD4914EA1CB300ADD432F14586E27AB693E2D3259DC59E4AC9E5CF95CE0383B083B47CA5B6AB6EFF67FF1DE8B43F1F34D7A2E24944979E5EDCB0044AB86638EDB4BEC6FEF7C8CB5E250DE32DC6F12B5B49B080E876E7E5F987CBFDEFEB53AEAEDF69491479640C1C7DD0DF37DDF4FBD41363DBB48D7C5958E9D2ACF218A39244F2DD981651333A723F886EFFD96BD0EDFC6B62D04EE6E866308A15B19539C364FAD7CC8FAD4B3DB308DCB450E24CF75DBB17FEF9CFF00E854B67AFDD5C6A1133CAECD1E4FF7970373671FDDFEF526EE3D56C7D8105DC6F2BA165DCAC075EA0F4FF3FE356EBC4FC3BE324D46D54BCBE548A8B16F66C967528A39EB9CCBBFFE00C7FDA5F4DD23C496BA86971EA28E0452C636A96E770CE47E7814CA8CEFB9BF45430DC453332C4E18AE338ED919A9A8340A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A2A09AEA084E269563E38DC719FA7AFE1581AD78D74AD321F34DCAC899C66305F3F4C71F99149BB09B4B73A391F62B360B1033802B91D77C5A34D590CA248D72C07CD1C6DC60F476E4F51C1ECDC0C579E789FE2AEE5616372DB1D543283B5CB77E89C741C6EF4F9BD3CBF5AF184B7570678E53E68FDD8731AE4A7F0E71F7BFE05BBFDEA3733726F63D03C63E388AFD7CC1825D76ABCBB9048AC4F1847D9E8DF3EEF635E6D7DAF4B70AA24691A3819FC98DE45C479DBF7157EE7F0FCCBB55AB112FE46B8F3800CF9C905320FB54525E33677AA163801578A62E5D0D3B8D627907EF33190A43BAB91BFB67FDEDBF9AD6434C4BEF5DEB83D0F355A572C725813D31E951753CD32D4492563BDB200E7A67A5474F528700EE1EF9FE948427F78E7DC522908B81CF7FA7141FA6293E94BFCA801C8C47656FA8A53190BB8038CF7ED51D4AB2BAB6E2C73EA4E6813F2181BE5208F71ED4F0CE84480E467A827AD2CA5739421BDC0C7E629D6CC9BB63E555C619B19007AE29812A3F9908DAC770EA2A482E9930E9F2FEEDA3CFAE7D2AA491189DD586193BA9C8A42C3951850D83EB40AC743A5EA8D1344AEE58F99BC80F8C7F0FF00ECBFF8F57A37C3BF114B7E5E05955EC2CE59258C3F0514BAFCFEC3EEAFDDFBCF5E38AF88F7650B83D3F5ADCD0F553696F3C0A76AC88CA3F870783C91FC3F274FEF61A82248FA6FC2BE21B7BF68A285DCA6F9261F2606001939EC393FE785EC23D4ED582ABC8A8ED93B3AF723B7D2BE76B1F184B636F6F16F533BCAD249E627C8A3E6FDC8F5DACCCCC3EEEFAE93C2DABEA7A8DE453DF4920B6955A68C3BA1E01652DB385C6E2ECBDBF85B8A485CCD1EE28E8E32AC08EBC1A7D6269F7E1258AD5A3F2E42A3764F393FA9E73E9DFD2B687D7341B277168A28A06145145001451450014514500145145001451450014514500145145001451450014514500155EEEEE1B58F7CEFB149C0E0927F01CD2DC4AA88C49C63D891FA753ED5C378A351F30C91C3777B04B22B1FDD34A036173C310AB1F1BBF8BEB412DD86F8BBC57E1E48317508122B6E63B14CB11DDF799304819C738AF01F126B66499BECD15C229F95BCC917EF574DE2168B2629E79A448B79D84898A367E6FF0075B72FCDF77FE05F76B86D4A5894B4914E641FED4616A37252B98B733C9331FDE139EB81BAA1921C8E254C7AED233534F78CC325D883D003C9A6240677E72A7A907EE8AB1A57200C90EE00866E9D290091C90320FB1C0157D224B7DBD11C8E38DC4D319BB33641FE1C74FAFF000D03282A2F396E40E00E7269AC857AE3BF7CD4F34A5B856231D80C7F5A884649DB862DDC019C0A60308239C1C1E94E8D19DB0149CFB54B1C5C1C8CE39DB8E4FE346664206D29BBB0E334142BDA380708F91D7E5FFEBD44E9E5BFCCBC0EDB866A7FB3DCE72C8C3DDB351B094B7CCC5881D73FFD7A041BD1810C0F4EA4739FAD3D2046055664F5E73FE14C573919C67DB20D38C6A1F21DB9EF8A40907978C82E18E3A114C8D9A2911863E53F91AB090C98CEC52BFEC1A268DB1F778FFBE695C7CA2CB18976490EE5E3AF503DAAA487B30C3A920D588A3C463070D9E94B28595CEE037AF7F5FF007A9DC4542CC405C9C761D855AB2729BD03106450A08039F9BB66A1F2C87015776EE76F7FC29231B4EE0FB40E719E78ED4C4CD0D3EEFF007D1BDD4ACD12109B3FD8F4F6AF41F09788E64D4BCE5B71F6A906E540556351F772E157A28FE1F97EEAFF001579648C19BE51851C019AD483537851ED5100B76652CA3ABED27AFF00DF4D412D1F4C7827564BFD666BE6BB8C46CBBD5C80BB93E5CB63F8578E3EF1CBF5F9B2DE876FA84370C822DC438DCA7040209E0FE95F3A78335D866B9537BBFF00760BED9E5C460E303FBADB7E65FF00BE7EF6DDCB5EBFE1BD6E3955423462E64077396570707E6C143F37E18F4FE1A5B13195B43B9A2AB5BDDC338FDD4C9211C1DA7BFF008FB559A0D828A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A29AC40524F231CF19A00E6BC433C46296596EE7B78E3525F0ACAA00F5254E323D3D2BC97C51E33B18C491D858996454F2C5C4B3BCABDFA2371F9EFF006C5749F13AFACE3BB5F3424932B602952163E064393B73ED96C7B2FF00178F6B5A95BDD4ED2A5B2265F395E53F00DF35437A90A37652D5F55B8BB97F7BF306FE08F68DDFE02B9CBC2CCFF39EBDBEE815A37770CCC5A24F9C9E4E2AAC5006766B8C12BF786776CFAD35A6A558821B742379381FDFAB8A8586DB74531FDE53EA7D5AA7B7B78E4E5C6F2DF280FD2AC2C724CA047F27AE179A4E56345065258E38DB1F3CB29EF4D689E539030075F98F35BF65A439525C601E79E6B56DB46013795F971D5B8ACDD548DE346E718B645890B021FE2CE2964B065F95D9BE895DB9D272E0229247CC71C0FC6946864E09545FF701351ED915F5738AB7B1DCDE5876FA0A94E9FB942AC04E0753C7FE835D92E928AB991F70EC070A29F1692B918873E9C5275CBFABA3843A6CAFC448C33E94C9345B9744CACAF9FF0064D7A2269726DD80B8F5F9B8A91B4885CB19433EEEB97DD52F10C3EAF13CCD74D78DBEF32F3DF9F9BFEF9AB76BA6305F9779057931B57A3268F69C7EE938F65A946996E186D8D57E83A51EDC7F578A38FB2D0379DF8241EFF7B754F3F86329C05DC3B8AEC05BA28F9473EA294C5B540C67EB593AACB54E279DCDE1D78FEE27CD9ACFB9D2DE3254A3E47CAD8FEED7A7BC0AE3040C77CD55974E8D94A38E0D68AB3EA672A09EC798CFA6921493B71EABD6AA4B638563B4AF38439CE6BD02FB47477017F2F5AC6D474B756C05CFA0F4ADA356E73CA8B47192A150A0E3D38A4DDB5C3A9F9B39E38C56E4F68117CB0B83D894ACA9AD76B908ADD322B7524CCA5068DCF0DEBA74E956536D14EE87722CDF3229FEF6CEFF002EEAEDF48F1CDFCF2B8610AF9B87CF95803E8DBB8FBBFED7F17CBF7ABCA512553F7085CF3815AD612315E5B6E7A9CE286CC9C4FA7BC23E2592578DAEE64820906115B82CD9C75EFDB8CF1F7702BD02262C8091B73DBB8FAFBD7CBFE15BD6B69565F36001C8CB7DA36C80647DEDA7FCFF00E3D5EE1E13F1369B2C6B15BDE9B91D86157692784014E3F1FF001A2F7262F97467694531183A071D18034FA66A1451450014514500145145001451450014514500145145001451450002B13C55AAFF0065E992488F18948C2ABB60FD71839E87DAB6C570DF13FC4B1E91A53C5131799BE431C722EE39EC475FC769A4C4DD8F1EF1A6B775792CB25FCCF20123F911191E4110FC5971F96DFBD5C1DD4E1D8B26E03EEF3DCFF155AF136AD35ECE64B88E380EDC6D8D36FF00F659AC9B3779D99FE5C20DA33FC4D50D0A3D87C304920DFB4E178FBD56E1B5F9732303CEE007DDDD4AC0C4890AB799286E80FDDFF3FDEA9E2532B04073CF38EF52D9B455C9ED6DFCC70B10662DC6F239AE92C34511A0CA8E9CF1D6A7F0DE9BB2312919F415D1C70AC68091F3679AE59CFA1DF4E9E8675B698AA0172C73DB157A3D3D15812BBA53DCF45157205DEE091802AD88D8E462B1B9B256331AD225E02E7B9F4A63DAAB824827EBD2B57C8321E9C0A916D970485C9039A91D8C416680E55549FA54BE41C74E4D6A0B73BB8001EF4FFB271B88E3AE6A86650B4E32402691AD8F7503EB5B0B147D87D73486218276FE353611906DB07241A1A105791C56B0B753C00291AD50F51434231CC001FA50D07BF35A66DCE69BE4E3D5A981926D89CB337FDF22A178B0718CFD6B6258BDAA16819B9228118F344B9CFE95426B28D9776C5CD6F3DB82783CD549633E98C555C5639BBAD27CC466043FB38F96B9DD4B4B2011E5A0F522BBF113127FDEAAB7DA789109EF8F4AD23368CE54D34796DC5AC9036EDD923A1FBD4C5723990B03F377DD5D86A5A2994318D7071F9D72D7566D6F280C36E7D3FBD5D909A91C3520E2CB305DBC69B402538C8FA577FE08F100B5D4E1DAB39675FE39F66E727A823E65FBCDFF00D97DDAF31449239432E0B7BF7AD7D22FA58A75F22692DDB8C796FB4B37D772D688E7923EC3D1AE3ED162B20DA54F4DAC188E3BE0707DB9FAD68579D7C2CD5755BEB5537B6F711C44651E491E50467FBCCC7AFB57A2D3D871774145145050514514005145140051451400514514005145140051451400741CD783FC62F175D49A93D9DBDBB471C7C0F306C39DBCB119DDF77A1E38FF00C7BDE2BE6EF8B57127F6E4EA6F21BD67C6D588308E0EF8C36E4FEF7F17F137CB53213DCF2E9F124A5A628BCE481D4FFDF3535B498884889E583C01FDD5A865B72F3E1C0CF5C0FE2AB6A9B106D3939E3B526343A37F2D49CE646F938EB8F45ADAD0ACC82ACCBCFA0EB5474EB3795C6E1927F1AEDF44B21195CAE4FE66B9EA4ADA1D54A1D59B5A645B610586C51C0157D61F31BBE29D041B6255039AB7021E80715C6DEA77C7444496EA0055193EB56123E715284E78EB4F0941446A801E94E1193C54CB1E3DA9EEB85F7A0572348542B6464E7AE2A42BC1539A92303393FA549807935560299880E71814C922E095EB574C608F6A3CBC1E99A2C4B288857AE3028F2971902AF15C70698546318EB45845078867818F5A618C9E073578C64FDE149E4F71458650F2C0A8DA2CF53C55F787F8BE6A8244DA70690D197710E0E473555E225AB5E48C3039E71558C58CB15C8A0199860C738E69A611B4F19AD1316D0462A368FE5E39FAD5220C1BAB6018B81FA571DE25D38A92557AF435E873C5B8924562EB16C1E120AF4E9ED57176644E29C4F310E88DE5B02093C66A64DAADBC8DAC9C8657DB4FD56368A6395E1BB1AA8A42301B0C61BB7515DCB53CD92B33D5FE13F882E63BEB6B69659668B786C88B062FE15F9DBEF03FEF7F7BE5FE2AFA31583286539046457C79E0A2969E20B49BCF6B72AE0F98CA6409F80EBFF02F96BEBAD327FB569F04C0E77C60E718CF1F53FCCFD6ACCA2ACDA2DD145141A0514514005145140051451400514514005145140051451400D9080A4B0C803246335F3A7C46D580D6AE6DB4E8E18C1C34861E5BFDADAFF45FFC7ABE899B3E5B6DCE70718C67F5AF9A7E229F27589ED239B7C68F9911376CF33E6CEDDDF7BE6665DCDF37DEFE16A890BAA38758991D8336D18EC3E63FED55C8A25386FBA3A20F45A420B72C7E463B40FE1FFECAB42D21DD8C807FD91D854C8D62AE4DA4C2F2B8F2C051D09AEEB47B65445F2F2C3D4F6AC2D2AD9576CB2020761FC35D66948CC818A903B5724DDCEDA68BC8983CFE356205E73DA95171827F0A9D540E17E6DD581D0340C6E007D69E53047DEC75A9100DC33F8D48A8AC727A0AA484D90AA9231B4FE029C171D07E95288D8E02E00F534EC043CF38EFB6AAC0355406C9DA076DD4E239E063D9A918E060741EB41939C632450B41898E3E514E65C2D377B3637702955B28BF2AFF00DF34C4232B03C8E734CC548EC7664F7A010C3206DA76111018C67F9521031F2834E3C2818A43800605201B8F5E95566DA41E39AB1332EDDA09DC3D7A540E015C9A4C6881D173C106A27E0F038A9D9941C27150B9F98F7CF39A4365671F37DEE95148BDC0A9F7E47A533CBF97815489655963C9E38F7AA17D6C5D0F1CFB56C3280791BB8ED515C440C78028259E5BE20B002762E073F31F6AE68C5B24319CA7B1EF5E8DE25B70BB9BAFB8AE1B5188AB324A32A3943FC35D749DF438AAAB323D0EEEE2CAE7CCB3B99A1981E1E291A263FF00025EDFEED7D69F0FAEA7BDF0BDA5C5CCE6691D72C5B7707A91F3727AF524D7C8961215951B03E66EFB4A9FF80D7D53F09278A5F0A40B1C6620001B036E507B90771C64F6E3A74ADDEE71FDA3B6A28A28340A28A2800A28A2800A28A2800A28A2800A28A2800A28A28018F8D8C1F0170727DABE74F885F659BC417EB651F97046E17E6CEE76FE2273D3EEFF00E3B5F46D780FC49580EB7341690AC11AB63E5003138E4FE3EDC7A7186A890754701E5969C80B9607007FB55ABA6DB012798FC28E307B9AAF1421A51B53007CA00F9456D585A979C6EE163159499BC11A9A6C5E6B7992718E02D75765098D01C564E91685DD79017B574C91EC039AE66764568302E7E82A544E41A5C53D0F6C66A12341F1A2E5CB7619E295395F9BA9ED48AC002A6AA3DEA0621587AFE15760B9A063C9C13C7AE68641C73F80ACF5BF4638539C7CA6A78E68D932A71B7BD3B13CC38820E31CD37E9C1A990798A4AF7E99EF52184678CD2E52949150139E4D2963DCE6AC988F70B50BC25573EB458068619391D6A40DC66A2287190452807B0ED4201D27DC151371D0D3D871C7F2A511B30F5F7AA02A3861D7926A360777F4AB8D0E49CE4544F18C0150E21729924E3776A88AF391CD5A9400B555D860F3D3DE8511390D68C724734D55C139E690DC8C63773FDDA72B87E4628E526E0579FD29922E54F03BD4C14E7E9D2A39B8E42EE14C4CE37C483CB0DFECFE95C0EA43648436D073DABD37C456FBD77004F1C81FC55E79A95B18DCF1C8E9EE95BD2673D5462C019650081C91C1FEF7AD7D13F032E6F534F7B5BC59594468F0B3B12021E9819C6381F76BE7EB308B200F9DA3FF0041AFA4FE0FDB3DB691222CD384DF968E7396CFF7BAEDC1CF51D76E7BD75743865F11E874514505851451400514514005145140051451400514514005145140095E27F16ECD2CF5D2622F234A3CD6DCDD0B13F28F4FAFBFE27DB6BCE3E306968F6B1EA2472A3C9C81F749C90C7D78047E3DB1CC4F603C9ACA30D26D1D4F1CAF4AE8F4AB2F324E9F2A76FEF1F5AC3D3A21FC3CF3CF15DAF86ADFE5F30F08400AB5CD2675D246B59DB08117E5CB9EB8AB43A01DE9DB4038340539E45647620C1C74C9A6B300431200A91B9F954E4560788755680982DC3349FC44738FF0A6909BB126B1ADA420C71F27A123B5739757F2FCCC5982939CE7EF0F538E9F4A88433DC30592CA523A8F2CC410FBF2FB8E7FDDFF00815491E9925CC8AA2D6563D5F614907E382AD57148CDB6C70D6A44D88836A019FDE2718FEBFE7FDDAD183C5164AF89EE1DDD7E6501197F2F95BF3150BF82ADA40BBA1D9B7D1D1587B7DD765A89BC116B1BE2253B2420EC665240F40CBDFF00DEFF00BE6B54919BB9BFA6F8AB4B97EECACD2738439F308FF67276B7FF00635A906BDA6CF26DFB54692FFCF3924556FF00BE6B89B9F094EA7305DCBB71830DC8F3148F6DC3FF0041FBBFDD5A65AE9B716937CA4C6D80CC19148FAFDEC8C7CBCAFCDFED52693049A3D221923986626DC98FBC39069FE58C7078AE534B17514BB50C80C442F96F217DE3FBBBBBB7CBBB3FF8ED75361233C419DB703D091CE2A5C4D2E24B1022A310E3AF6AD00A33FD69AD1A81D38A8B1572898B8A6B621C64F04E0FD6AE1DBB48C566EAB21113719CE083EE3E65FF00D05A9A570931B3DD451AEEDC1770523D7FD9F96B36E3568A103732827FBC76E07BD43A9283B137B0063F5E76FCBFCF6B7CD583A85A98A16B96DA8DBB0A30F84FC3FBDFFB355A8AEA45FB1A92EB304A4F94E255E72471FF00EBFF0080D655CEB16ED2EC8E5697FD91C38FF80D733A85A5F5D5C6E89645627040E3FEFA21B77FC076B5411785A7901329BB3C7FAB8A35FEEFFB4557FEFA357C88CAF267412EAD148C5A13E68EE07C9FFD8D4B67AC149C190305EE08AE757429ADE45103C9B947409B0A7FDF0CDFFA153B1388F6DC9F308E77AC8A98FC5B77FE8350E2BA0D37D4F458664960DE87208E2A6280F24570BA2EA57B63F3443ED707DE2BBFA7FC09BBD767A7DF5BDF42C616FDE20F9E26E1D2A1C6C5C6572AEA165E744D86C1AF3BD6ED0991A36EA7E500F6AF5575DEA78ED5C4F8B6D446E5C019E714A1B8AA2D0F3A31ED986DF979E78DC3F2AFA4FE0EBC4FE1B0A495B98C90F03A1062F98FDC2792A703BF507BE6BE7F8E1DF290A305DB09CE3AD7D21F0C6D21B6F0EC4630378CC720F2D91D483F71C37CC0AE7183F51C1AEB89E7CBE23AFA28A2AC61451450014514500145145001451450014514500145145001587E36B24BEF0BEA11C9D56077420676B85383F81ADCA8AE1774320E7EE9E871DBD687A81F3AC7179576F1329043608F45AEDFC38A7CA1BBAF4FA7B5727AE466D35EB95738707E62A3600FDF8ECA0D751E189374617A719C5724CEBA2F43A0DBC9A60F9BEF53C63CBF7FBCD4CE0EDFEF6EACCEB20BA7F2A07604212382D582B631B4CA645965C9C9DC1793F8D7404FCEBB073EB8E951340EE4F9AB6F2A9E31E5F3FF00A153426AECA967A744CCA23B7B7DB9C8119FFC7BEED6BA45120F9ADB803A3C3FFED533C88D10158D1B9EF4C92455CF97951E99E055DEC0A372E9BC8A25D836C68A3B76FA0AA72CB0CBBB0B91EEB8355E49439254927AF02A032C89C9B76C7FBAD52E6C6A091709030509C7A6EA6496E9292C7EF7B5564BA47393F29AB714833C54F331B822382D36485BEF70AB9F5C1E2B523057685C6DC73F5AAC8D83D6AE4014723FF1DAB5233712CA92C8300FB52BB0DA33498C9F61D287501B9C669011390A338FC2B3EE24EDB77EC3DBB7F96AB52C80658F4ACD9E50093C0A13B035728DCDA99983901C818FA0FF003FFB3541358ACCC3CD9318F4ED569DD9C123A1A5DCAAB9039A4E4C6A1DCAD6FA5C041063F97DF8ABA34F8BC909F645703F8093B3F2A679EDFC2327B002A2967948DB242187A15A39D83895EFF488AE558F916F1E7FE7A82E0FFC06B2E7D02DCAE4C2FC027F768C31FF00025F97FF001EADD4BFDC7058A9F4F969258565C318D5DC7404B7FECB55CD72796C72ED656F1CEAC1AE0B03C3A3BE40FAEE5ADCB0F2D957797629F70B8FBBF954ED6FF312B00563D703683FF7D7FF00134B690157CF97181EC4E7F3E946E887A32D2A82303F86B93F1AAA881D48EA335D7015C4F8F6418C138C0E7E5E94456A29BD0E63C3BA78BED662B66EB3B00A410307EEA9FCEBE96D02C96CEC15311EF600B3A2E37F0304FE1DBD315E25F0B3434D66F9CB3E0C655C295192A4B0DFCF5C109C7BFB57D002BA96C706F2B8B4514550C28A28A0028A28A0028A28A0028A28A0028A28A0028A28A004ACBBAD7B4DB47293DCE08E0908CC3F30314EF105C1B7D36475CE0F071D71FE463F1AE46DF6DEDB8678F637753CE7FDAAC6A54E576474D1A1ED1377D0E67E27D9409A81D56D658E4B7BDD8C8D1B06DFB77991B8F4F97F4A8FC1F71BE5C13C9FCB1FE7153788F469D6D2E0DBCCC906C72F173B376339C7FC057F0AA5E0446124819B3B4761DEB173533554BD9BB1DA8C94CD204E68CE063E5A722E083F78D41D039635EBB4523E141E2A450091556FA628A4639A5704B51259CE0FA0ED58D73A9AEF658955F1FC4DC28FC3BD25E4B2C8180181F5DA2B9B16F36A3A888DEE0436E0E0607DE3D39F6EBF9528DE4EC68D591AD73AF46A8C5AE6E1F60C916E4A05FA91D3F3ACD7F19E9C155DAE6ED37671FBD72456F789F4B4B4F08CA962A36A052D81CB7CC3713F867F335E67E2CB1B7FECAD24E991B35E33CC2E76B6029DEA518823E61B0B0C0C73F91DDC62B4395D4773BAB6D723BE5DC932CC3D0F0D8AD0B4BD20FDECA9FD2B17C1FA3412EB2228543C42D53CEC8E0BE14B7E1BB762AEEA96FF00D937EE15CB404F20F55159B869746B4EA5DF29D1433162063835A36B213F2F3E9587627E55F983023209E8455FB59499081CF3517B23468DE8191C95C1A649C29C1E2A1B398B3525CCD8538AAB9935A99D7D703775FC2B2CCBBDB2D525F48771E702A9D8481CB1273CE2A772D16C4AB1AEE2393D2B3AF35582DC96924418FE373C0FC3BD57D62F09BC8EC60622561972A3EE8F4FAE39ABBAF786A35F0BCCF6B1879502BB1FE270319AD143995C99CF95A4737A878DACEDEE0219A59187F706D183F4A7D878AA1BB76F2BED40A0CB618903DEB8EF16D8A6A1A969634FB78E28E3B54865600E7CC0EE4B8C70720AE739AEF7C23A4DB5DF886E2E6CA0F2ECA2421148FBA323683EFC66A9462EC96A73BA925BA1F1EB115C0CAC8B381D88C30AD3B2BA0EB946DCA3B1EA2B03C63A3A5B5CFDA6CE4582667C6D1D08CF714DD0B509301A652AC38715125CA7441B68ECE37DE30295540CFDE27EB552D255750E86AE311D477A148994417BD701E3F24CEC176E0F51DEBBF5C66BCFFC7B98F5543FC27191EA33551DCC65B1DEFC12D2648F485D425194705539C6D219B38F5187FA67757A7D792DAF8A2E2CB4AB5D1FC3686382DD70F77227CCEC4E4ED43D1724F2DCE3D3EF56C693AE6A769FBDBAB9F36327E6133703F1ED5B7B58A76305879DAE7A15155EC6E92EED92688FCAE3F2F6A9EB6317A682D145140051451400514514005145140051451400514514014B588C4961202338C11F9D7211C5C70DD0EDAED6F0036D203FDD26B8F8BF766E236FBCADFCEB96B6E8F4308FDD68925B64B9B692291722452871E846DAE4BC2F64D6FA85EC6C810AB6081D07A05FF7576D76067019541FC6B12CA009ACEA3D097937F1EFBAB25B9B4D345D8C65E9D09F98E7F5A4FBDC0E3F8A95081F2FF154B045A52154E3AF6AAB710BB939E6A6DC464FE94D055BE55EA68B0D68625DD8C8EA40E45544D291A43B970DFA57546304638A46B4561C75A695995CDDCC9B38EF618FC976478981C8914B2E3B8E2B9CD4FC330998BDAB7951E7950E1803FEC923207D6BBD585E35F94FE5552E61776DD8E73D4D68DDD599164DDCC1D2DDB4CB2F26CA08C3BF2F2392ECC7DCFF0091546F2D2EAFAE03CF367041081060574325A6E3939FC2962B45539C60377A5AB2D28C3628C109B781501DDB41C93DC939A7D916DC7DCD4D72410557B52DBC450F3F9D60F7197AD9F6B01497AC00247A544BD734B31CA63DB9A77D09EA61DD36EDD54EC898E4201C55C9572CD55E38C09F7534032E2C629656B80D2C72920968D88E718EDED572C6E6F6D176C770F227F75FE618AB304692038A94DB2903B568AEB60B292B3302FB4486F2E7CE6B58A3DC72444CCA0FE1FE15A51B4F6D6420B1822B68D7FE79A924FB9273F9D68C51B2601E953ED661CE71549B25C63D8E5EE74C7925325C92E4FA9EB55E3D3D84A5917683D6BA892D833658E47D6A216EABCE3BF7A87A95CD633ECE13100187CD5788C6D3F7A9E51474EB4D72DB718CD2131D6E4E391D6B9DD7B4CFB6788EC83A86520120F7C6EAE923077669B342ADA9C12B6731AB9155D0CBA91DA5824276851C7354B58569EDD491C29F947A5740D35B3DB2AC6A7CCEE4F7ACED42102D5F81F7AA6C75D3DF53B2F03B16D0932DBB0E47E82B7AB0BC16BB747C0FEFFF00ECA2B76BB69FC28F1AAFC6FD45A28A2ACCC28A28A0028A28A0028A28A0028A28A0028A28A0042322B97B9B2297ADDC93827D7DFF0095751595ABE2397CC5E1BCB39ACAAA4D5CDE849C6565D4C4BADD046DE5282D8EA456658A96B99A6901124A89B876C8DC335A06412872CD8A8D5E2668D635E8082D8EBF76B963B9E8CD7BBA8DC1CBE7E51EB4889FA549B78FA9A157278E9458842608CE3D2A558F3C934AA07A54D14791C7E34D22AE47B4B5481481DCD5868012294E076FFEBD5588724423E65F7A85D4E7A60FDDAB0700FB53586E1B88FCA9DC68A9E5E7A8EBDEA29F0A876727156A461D0673556504E7BD436514B682738A9F188F229A8A19BA74A277C9EB5994D8C72777078A4918AA8F4A4560C7A66A491418FD6A6D7031D81C9EB51BA8073EF53CC00623DEA39395C8AA42B96AD48002E39356C292C38E2A95B31073C55F8F2C00CF157711222E4F23B548369076F3F8528E178C703BD4A1548E38355702B328DC4557298CE3F2AD0F2864F14C78324F534AD70331D09231D3D690212D92718AB9343B4E31CD40CBC9C8A2C2635783CF5A8EEE7862B88639B70F355D46DFF80D4DDBD7354350666BF8154642C7F965BFFB1A24EC89A71E6958D18E05E7CA390075AAFA9B3BC315B20F9E56E94F8246460A48C9ED576D2C05D6AD08C9E7E5E3B0EA4FE5536BEC7473283E67D0EB74083C8D2A15239619FC3B7E98AD1EF4D550AA1540000C000714EAEF4AC8F124EEDB62D14514C414514500145145001451450014514500145145001587E20037E5B3FEAF8C7D79FE95B9597AF5BF9B6CAFFF003CCF23D8F1FE159D45789A52928CD3672B6E3CC7280D5B9E1FB3AA64F53BB8A87FB2825C8916460AC09003F7AA5347730DF29632C91938F98EEAE35A3D4F564F9D68CD020EEA551F2F140EC68889206F1838E6ADA328EC48B80DD71CD5D838000EFD6A829F9B046307A9AB70B1DC31E9421C9685ACF35048C54F6A947238A1D01EF8AA335A1518BEFE466918FAF6F4AB5804F4C54527CA3A66958D13B90ED04F19AA97248CE3A55B790E0838F6AA7A848B1C449C7B54B1A2AB3041F31E6A176DC71D0D54679A563B781566DA120658926A2C5B25870AD9C74A924CE091DFA54F6F6A4A1603814AF096040185A2C2302EC316254E39CD426419DBEBF2D5FBCB6F2BA6706B26EE1753E62E7DC531B346D7B67F3ABD1019073B79E2B3619772A7BD5DB162F9E7E6CD3251A318CB86CE17DEAC290481FAD471A90706A544C91CF02A8400FCDDA9C5C743D69FB30320FD6A37600F5E69D84F5294FCC847FB3555B3BB156E56C1C8E777B5556EB9A91362103781F9D55B9575BA0EAA0A919FE956599634791BA2A927F0ACDB3D545E45B628199CF14A5AA1D2BA774235C37DA863AE7A576FE138374925CB0390A1013DF3C9FE43F3AE1AC6DEE67BB2F2C06319E86BD33C3B0791A6A67AB92E47E9FD2B4A2B5B938B9A51B2EA69514515D679814514500145145001451450014514500145145001451450014D60194860083C107BD3A8A00E7F52B06B7944D164C24F233F72AB4E32A438CFA1AE9D802A411C1AE55E40781CD73D48D8EDA1372D3B154120E0F4A5518E0738A0AE4E0F14A38358B365A682B293C8A9EDDC8EBD6A307E50C78A7C64F1D08A0AE85D8C9DBC9CD2B119C8A8216230335206CE4555CCDAD452DCF3D2A2940C8DC2A43C80690F20E714868CFBA62BC0E0D66DFE5CA466B4E71963935997A8C7E751CA9C83526C89EDED11A3DC4607AD3262B11F948C763503EA89F672A1B6498E37564D8F872DA6B94BE9EFEEE5BA2725D6E1C0FA6338C7B521EAB73ADB1BC51014719CD367B8423038C9C62B3AE229A218887982AA996E492A5429F5ED55A91A6E58D4AE530010368AA4103826A8EA9637574D98F526B72391B10367F3AB364C2DACC2DCDCA4F28E0B0DB97A5B15B909C46E507406B4B4D4C0F7AA3165E52CE3196CF35AF611818200C8A9B858BF0E540C0F973539008C7715144400335614000FEB5A221899DB9CD53B8385603A1AB5370339AA53BE495A6495A6627A719A8B041E734F6F9BBD20E4FB52149915E43E7DAC9103CCA367E7D69BA569315A00474153EEE571D7AD5AB64F34344832EF8007A9A6F56545DA22E9D03DE5F24683696392DE83B9AEDE3458A354418550140F402A8E8FA6AD84596C34EE3E76F4F61ED5A39AE9847951C1567CEF4D90B4514559905145140051451400514514005145140051451400514514005145140095CE6A566D6D333843E4B1C82A385F63E95D2515328A91709B83BA38D94AB1574E948A30495ADAD7AD235805C468AAC1BE6206320FAFE38AC40323049E6B9A71E53B29CD4F5274209DA7BD380C7E751292AC00E9532E71EB506A2AE0024F6A93B13511195C505B8FE548762456C8C93493B8518CD47D18D4321C9E29DC12193F3C9CFD055620143B875AB0C3039FBD55256CE474E3BD4957B104D142092C01C7AF4A6AB804046031D053C82F95EDEB4F8517230BC9E295C1B6C79B908A039193D3351DF3A988F96B9C8A6DD26C9D14E081CE6A68CE6D883C0ED5572794E7E58EDE6E2545936F4C8E9535ADA430B1F2E2099EB53C902891997907F4A6A654FCC32074352D8D368B2B18CF038C55889CA3861D2A389B79F5EFC53D803C82690EE5D593279EE2AC2C9F2FBD66C4E4000D59858F258F4AB4C4C92662C39AA9293BB9ED5619C11C1AAEFC8DB9AA20848E98C9A5EA36E2940E33DA915496047393818A68996C214DD26EF4AD5F0FC465D423001DABC938E98FFEBE3F3A9E2F0CDD963E65CC480F3C29623F956FE9D6115841E5C409279663D58D690A6EF766352B271E545BA28A2BA0E40A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2802B5F43E7D9CD18192CA703DFA8FD6B9506BB2AE57518BECF7B2AE0052DB97038C1E6B1AAB4B9BD076762353CE3DA9E1B040CD471E31CD3C9E338E6B9CED15B9268E4267F2A69381C1A0370327F0A96311B3DEA393EF66965E9D6A39A50884BFE14AE316519184E33EB50ADBFCE496C93D33DAA8DCEAF1C24EE9001F5ACEB8F122BE63B76DE7D47CD4D2B9518B66D5C3C56EC7CC7013FBA3A9AA6FA8F963E4518F56AC26BC9263B88909F7A47B89980CC5BBD726A944E88D2D0E862BE8E790F9918DB50DDEAAB1B0458C006B13ED32A8C2C2723AD479924915CC7F2FD69D8BF65D6C6D8BA865FBC7693FAD4D146BB30B8603BD7306E1D4E5D381FDD6A7C1AEAC4DC48531D9C5270319C0EA42F9783C63D29AB27EF3FA56345ACBDCC79890B7D0568D83BDC8C90D19F4350F430B32FA360D490C8092036EC1DA45451292AD9FA034F51E9DE920249482B85E2A239DA07A77A576F9B18A1B8E3D2B444B1BC9FA55DD121F3F51810F215B7B7E1CFF4AA478ED5D07846DF99AE9B927F76BFCCFF004AD20B530AAED1674745145751C41451450014514500145145001451450014514500145145001451450014514500145145001451450025637892DC98D2E5464A7CADF4EDFAFF003AD9A64F12CD134720CAB0C1153257438BB3B9C7A9E3AD3D5B02A1BC89ECEE5A07E083C1F51D8D01838EB5C6F73D283525726DD95F5A45C10735179A01C50AD938FF0080D432C9F036F3E9552EB27000FA66A60718C9A5D81C54EE0665C5843710112AA9DDDF1DEB19B40119CC5C73D2BAA3181F8530C3919C629DDA2D4DAD8E722B2C92AD1B7157BEC51888150B57248C679E08AAB3EF4E9920F156A66BED080DBF538FE3FCF8A6B5B29562C00C52F9B332908BDF04E69EB04AC307229F3587ED34326EEDC392A83033EB55EDF4C0D265E3FCF8AE896D00E4E4D39A1F970063DE939B66729B655B55222D88A140F4AB90C7B39FE74B12045E0629C48DBD7F1ACCCC9861531DE9A0E0668DC0AFB545BC33E0718A689B926771C9EB4DDC41249A682493CE2918F38CD68896393748DB17924E00F535DE69D6CB6767140B8CA8E4FA9EE7F3AE6FC2DA799AE05DC83F7719CA0FEF1F5FC2BADAE9A6ACAE71559733D05A28A2B5310A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AA9A9DF5B69B633DEDECAB0DBC086491DBB01FD7D077353C922448CF230545058B138000EA49AF9EFE2E7C403E21BB3A7E9B2FF00C4AED9890CBFF2F0C3F88FB7A7E7CE7002652B1A717C4DFEDBF163DBDCC7E54170765AA8FE0037603FB9FE66BAFB79F70C6718EA2BE6DD32F18788AD19725FCE50B8F5CFCB5F445C2F97234B1F66E47AD7357493563B30D26E362FCCDC0DB4F89B20E7BD5286E165E49E9DAAC29DDD3AD7333B132D2B92D8A994F6E95043C54EBF85210877060146477A9150E72D4D5201FC69E1B0C7BF14C00A2F42A2AACD0A9E83BD596627B605464839AA0B94042818951827AD3E4648939A94C78504679A61B7595793F28F5A0B4D7506505432544FEDCD4DB4AF56E3D2A39B81C521323E02FAD3474C0E9484FA50D80339E6A48B880E1700F4A66E00FB9A648D8FE95119B048CD34172C1936E6AC6956936A576218F81F79DFB28AE7F54D562B0B596E6E1B64508CB1AE0FC3BF15EEEDBC6B05EED3FD9E3F746253D632467FE05FFC48ADE9C1C99CF5EA724743E9AB4B78ED6DD208861106054D50595DC17D6915D5AC82582640E8E3A30353D759C6145145001451450014514500145145001451450014514500145145001451450014514500145145001505E5D41656D25CDDCA90C11296791CE028A4BFBCB7D3ACE6BBBC9561B7810BC9239E140EF5F387C4CF88B75E2CBB6B7B62D6FA442DBA38B1CB91FC6FEFE83A0F7EB4D26C994AC6BFC51F89EFAEA4BA56865A1D349C49310435C63F92FB753C676F43E55712FEECE4F5E99A64F31E7E7EDCF355A67CA73F85696B2327AEACE9BE0CE92357F899A68981682D0B5EC981D3CB1943FF007D94AF6B81B31461BD2B82FD99AC524D635FBD65CC905BC70A9EF891CB37FE8AAEF7EE4F2C7FDD723F5AE0C4EE8EFC2F52B4F1B46E5A3C8F6A96DAF33C39208A9D9030C11CD53B9B5E772706B993B9DDB1AF0CA1875CE6AC2484AF26B9C86F1E2655718C56A4172AEBD698AE69071B8739A997F9F5AA28E01E0F156E39576E32D42044E53E5FF0A81949CF3803D69E1814058F39A6336E7C0233F5E6A857107CA38FBB9C734D29939FCC76A7E3E5E7B7A533738EBF4140C648368355256C67D2A7B990300738F7ACD79946496E00E73498C90B65BD2A39E50A0F3CD5592E86321B39AA3717A1CED5E69584596BAEB95C72C066A20EF3B623E07AD41146D2B65BA7A55F5511A610629EC239CF887653DC781F565B38CCA628967940E4940EB93F875FA06AF06B790ABA1E9B7D3BD7D4DA2C56F71A8B5A5D44278EE21923788FFCB443B4303FF016AF98358B09349D6EFB4E9B892CEE24B76EFCAB153FCABAE83D0E0C42BB3DEFE01F8ED62923F0EEA12FEE673FE88EC7EE49FF003CFE87B7BFD457BB57C3DA2DCBC2CAF1395742082A7047BD7D57F0A7C6B178BB440B70E06A768A16E17FBE3A0907B1EFEF9AE86BA9CD17D0EDA8A28A9340A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A2B95D6BE21F85B4662975AB432CC38F2ADB33367D0EDC853F522B80D7FE3C460347A069849ED2DE1FFD914F4F7DDF8534AE4B9247B4D61EB1E31F0E68C645D4B59B38658C65A11287947FDB35CB1FCABE65F12FC44F11EBCACB7FAACE6161830C4DE5C5B7FBACAB80DFF02DD5CA3DE6D241603D4034D47B93CFD8FA5F52F8D9E13B4FF8F617F7D9CF30C3B403EE1CA9FD0D729AAFC7DBC7E34AD1ADAD955B992EE56972BFEEAEDC7FDF46BC326BF8B91C3607D69B0DCF9C78042A7AFAD35144DE477FE34F897AFF008AADBEC57F24515AAB17315BA796AC7B6FF9998E3FBB5C73CBDF393554393D7F1A566E303D7BD349224796E78CD3260AC36F229A386E99A5639C8C301F5A607B47ECBCB893C4AA7E6622D3F0C99F3FCC5769AAC06DB5CB880F473E6C78E983F2B01FF02FFD0AB84FD98AE02EB3AEDA96C196182553DF0A5D7FF6A57A8F8FAC99618B5681726D0FEF80EF11FBDF97CADFF01AE2C446E7661A56919AA370181C8A6BC7904D491302A194E4119069EE9C1C76EB5C691E9997716CB2718FAD51612DA9CC792BE95B722679155A44DDD053BD8562BDAEA68701CED61D8D68437A376148CD655CD8ABF20007D6AABDBCD16363B014D3423A6171DC91ED4F8EE3805BA9AE4D6EEEA238DC481EB522EAB70A39407BF5AA15BB9D4B4F80D86E7F878AAD3DC80D8358275795B8F2F1F8D559EFAE653839FCE95C0D6BBBE40B856ED59935FA6D23391E82AAF9134C46E635621B1D8C091CD2190EE96E1B8FDDAD58860098CF26AC450ED3C0153228072680B090C7B460E2A46E3FC29C077FD29B2100124D263B12F86DBCDF12B47D04306588F476E9FF008E578A7C73D2BFB33E24EA0C91F9515E6CB94EDCB28DC7FEFADDFAD7B9FC3546BA5BFD45B1B26B9748C9EC89F27FE84AFF00F7D579BFED3764A9ACE8B7814EE9A092127BE232ADFF00B50FE75D944F36B3F7D9E5366C137019FC6BA5F077892F3C37ADC1A8D8C804911E4374901EA0FB1AE4EDDB077723B55A47048E4FCBEF5D871B3ECBF0778A34FF001669097D60E036009A163F344DE87FA1ADEAF8FBC13E31D43C2BAA25ED94BC702588925665EE187F9DB5F547853C4165E26D121D4F4F72639386427E68DC7553EE3F5183DEB36AC6B195F466CD145148B0A28A2800A28A2800A28A2800A28A2803C4FC49F1D8A398BC3FA62040789AF1B2587B46A78FCC9F6AF2FF001378F35DF10161AAEA93CB1703C80DE5C3C1C8F906031F7619AE3C99A43F3498CFCD814CF2573F312C7D4D5A4918377DCB73EA4092B1E5FE955CDCCCE7E54207FB4691902FDDA70200CE3FBB8AA10C71239CBBE47DEE38A618D00F9BE6CF3C934E2FCE71EF513302011D2801CF81C851F854D11DA88A7F1A8621E6385ED52FF787FB5F768024DDB475FCA80CA3EF73C71CFF00B351119638E38A4E72477EB40897711D3A6DFBA2A4C6781F85428C5980DD819EB52A121BDBD6819E91FB3ADCAC1F106E227E0DC69D2C683D583C4FFC90D7D2771025C40C8CA18302391EBD6BE4EF85F7F1E9BF12B42B8909313DC7D9DB031FEB10C7CFFC09EBEB380868C023231FA7F902B1AAAE691763CD74B0FA7DF5C68B704EFB46CC24FF001447943EFF00DDFF00795AB589F94527C4AD3A58A3835DB35FDF589FDF63BC47EF7E5C37FDF5EB5069F771DE5AACD19F958722BCE92B33D8A72538A6492004E57BF6A85E3EE3D6ACE33B6984023A734B72C8368230698D02B0E956D90E395FCA90AFE18A2C2339EC95C702AB8D381E82B576E0E77734810631838A5A8CC9FECC00722956C514E76F35A8F19ED9FC699E57AD1A88A022000C0A718D76E73570C6318A8E45C0F9455202A95C72718A14739FC87A529EBCF5F5A1739E4D0DD82C38F03358FE2BD4174CD26698B056C155FAD6D9DB1217635C83A9F11F8CB4FB051E640B3091C76D89F39CFF00BD8DBFF02A95AB06ECAE7A7781B4D6D2BC37656D201E64502091FB6FDBC9FAEEAF24FDA7D835CF87D70785B93FFA2ABDDA0411C208C1DA3AFA7FF5EBE77FDA52E19FC5DA6C19E12C0375FE2692407FF4015E85347932776D9E5D175047249A9D30CBC3F2DD775574C75C53D0E187D6BA4C07A39526BD0BE13FC4497C177D389A07BBB2BA5025855F69571D19411D71918EF9FF0066BCE1DD98E4E734B0C85587A8E693D771799F61785BE25F85BC48224B3D456DEE24E05BDD0F2DB77F741FBACDECA4D75F5F07BCEF14FBD0801F918FE55DB783FE29F897C362386DAF59ED548FF469C79B111E83272BF452054B8F634526B73EBBA2BCBFC1FF001B740D676C1AC0FEC7B83FC72481A06FF81F057FE0400F735E976F345710A4D04892C4E3723A306561EA08EB525A69EC4B45145030A28A2800A28A2803E1519C649E9439E7F84B7AD0460F039A45CE31B76D6A730DE3773FEF734D1C9C8C647B53C1C373B69A36E39A632323D3AD31CEDA7EDC1C91519196CD2044F6CB8466C727E5029DF51CB50A8111416F9B1EB40C95F95BF0A001BE54E07DEA4EAC40A77DEF97FE034BF39385EFDE810D4F97A15DC7D7F86A75E57AFEB502138C0FBB5327DC000A0043732DBDDC5756E0096171221FEE907729FF00C76BED3D2AFA1D42DA1BBB47DD05C22CD1B63AA360AFFE3B5F165C02064FF0D7D37F02F561A9FC3CD390B869AC4BD9BFB6C3941FF7C3256735A1A44EFEF6DD67B768DD55B72952186412473C579243BFC31E21B9D2DF7FD9776F809FF9E67EEFE5F77F0AF641C8233FE4D711F12B41FB769E2F2D53FD26CF2EA07568FF008C7F5FFF005D71D48F53B70F52CF958C89E3B840E847FF00154AD83C375AE57C35AC1204721E7DEBAB42B2A65474E6B9CEF1D1F031FDEE952796A7AA01F4A8C379670C303D6A556DDF4EC6AC921687EE9DDD7D6A3686453C2E7E9564827EED2818C668686541148474FCCE294C057A945AB3D3963D474A85C81DC71E94AC040F1A2F5249AA9712606071562794283BAB2AE276924DABF7A80B6A293B9B039A9A24C2E5B18A8AD915465BAF7A8352BD5850E0F3525147C43A9795098623C91D6ACFC26D3BCD9EEB5171969196DD0118200E5FFEFADCBFF7CD729AA4BE6659F82C326BD7FC0BA4B699A2DADBC89B648D3F780F673CBF3FEF335553577730AF2E58D8DB9B11C200E7DFB7E15F2AFC6EBD17BF12B5300E52DC4308C7B46B9FFC78B57D517677CA10B703032781FF00EAAF8BB5BD40EAFAEDFEA52706F6E649F1E9BDCB57A14D1E632A0E3A64538609CFAD46DF374A14E49FE55B19D85900EBEBE9480953C671DA972327B5349C2920F4A90412906318EAA7834D8E561C73F8539727839DA462A253B5B0691496962DC572100C1C1F6AEA7C23E38D77C2F701F48BE9224CE5E13F346FF58CF1FF0002FBDFED5723C313D3EB4ED8CADF2B119E80F34C8B1F4A7847E3BE9D7AAB0F896D0D8C8386B8B705E227D4AFDF5FC377D6BD4348D674DD6ADCCFA4EA16D7B1F0098650DB7EA3A83EC6BE1E4B978B00839EA4F5AD5D2F5DBAD3EE96E2CAE65B79D0E04D0C851C0FF781A56EC3E668FB768AF9E3C23F1DB54B40B1788628B5287A19919629507F27FA614FBD7AC786BE247863C42116DB514B6BA61CDB5D911C99F4EBB58FFBA4D271B16A699D7D145148B3E15231BBBEEF4A8C9E33FDEFFC7A9EAC39C6DEB51311DB2456A730A7A669B93819A76E19CFF9348BB436698C461CF3FF00EBA627CCC01FE3A739001C9ED45B8CBE41FBA3BD202C6E07F0F9B6D24BF794EEA6E7A9DB81F7A9E8E39CEEE9C502233C9E3AFF002A50C73CA703FBD42F603AFDDF9A8C120FA8A0040371246DFEF62A75F403BD4483A1EEB42484642804F61EB400F9D884E4963D80AF58FD9AF5B16FABEA5A34AC71710ADD460BF01A3386017D487DDFF00AF2A8E3511E58EF623924569781B59FF847FC63A5EA6CC628ADEE57CE279C44E7127FE38C686AE8A47D99036533DFA8FF003F8D13C61E32A38CFF0021505931C618E4838CD5B1C8C1EFFE4D7335D0D6F6773C4FC61A3BF87B5C66806DB5B83E642A0631EA9FF01FFD996B4344D5BCD55566C1C5775E32D0D35BD2A48301651FBC8DFD1C74FCEBC661926B0BA78A5051E262ACA7B115C538F2B3D6A33E78EBB9E9D14E1901C123D2A54897EF427F5AE6349D503A819E7B8ADE86638C83F2FA52B96D17390177050DF4A728E3A0E3BA8A6457008DAD8E68924551F76A844524813239CD529EE3032064D5891D01C9E7EAD55E593238603D8526328CC6473F37CA3D2A00020F5F7AB12B8D849C64D64DF5D80A79EF525244B7177E5273F8735897970D2B9CE7D852CD3997383C0AAB2B151903E950DDC66878534C7D5B5E8942EF82DDC49313D0FA0FF811FF00C77757B55AC620B518E80724F4FF00EBD71DF0C74896DB4AFB4DD295333991518741F2FEA76FF2FEED76378E047800E7B67FC2BAE946C8F2EBCF9A56396F881AA8D23C23ACEA2CE50C36D208DBFE9A1184FF00C7CAD7C811839C7A57D1DFB426A06D7C07F6556C35F5C471B2FAA0DCFF00CD52BE748C12BCE79F7AEC82396421E09A4E869C4827B9A6D5923C01B0E6998E0FA5039147A72290D02923241A64A36BE7919EF4E51CF271C51260A1C7639EB431ADC5ED83DE9E393C1CFB5451B0381DE9E0E4F7A62689063DA9A515BD8FA8E284F7CD38673C0E2991B021991C6C6C91D8F5A9E3BD740048BDF382BFD6A0EF934A395C66806769E1DF893E21D0623169DAB5C476E00558DC8911075C056042FE145715B558F2B8FC31452D064878278FD2980F029C4E7349C13CD310673D7A51CED00F4A09CB7D681D7E6A006498E7EB4F8388DC7F7CD324E00E7A54F0A011AE7FDAA01EC3C1C87F95784FFBE7E6A62905BB7F769581CFDEE29A31DC714085DCC071F2F1D5A8C953F756839047F16DA09CFDDEBE940031218FFB5D29F0202AC4F53D69215C0DCD9057818ED4E40558BB15DC7A5004B919CFE955A5C79B8FBCBFED54C1B039E39A81C112939EB40CFACBE136B635BF0369574CFBA648441312724BC7F2313F5C6EFF0081576F19C8FEBFA57827ECCFAC0FB3EAFA348CBF24897910FF00786C93F0E22FFBEABDBAF752B5D32CCDDDECA22897A772C79E00EE6B092B3355AA2E4E81D48F5AF31F893E1A2EADABDA4799221FBF503FD627F7FEA3FF0041FF00769FAA78E754D42E045A5AFD8ADFA02C03C8DF5EC3F0AE8BC35F68B9B757BAB877739DDBB158C92923A29CA54DDCF1FD3AED918104AE3E6AEC747D44B00A4E6A1F881E0C9F4EB89B56D2E332D8B9324C800DD6C7BF03F83FF41FA5739A65E3445581F4E86B92CD3B33D38CD4E3747A1860CB914BBCA8E1BF4AC9D37511228F9AB404E8C3390298C5918B1CFCDF8557B8940C81938A6CB3E7FF00D75997B73B54838FA520B0CD46F42290B8CE3AD73B7572D349D4E077352DECE5D8F35523E58F1F4A86F52AD62546C28E3157FC35A59D73598EDD86605FDE4C48E360EDF8FF00F1559CD90A540E074F7AF57F01683FD99A6219900B89FE69491C8FEEAFE03FAD694E376615A7C913A7B489608547038E0FF8553BD9374840FD6AF5C37971E0704FE7FF00D6ACC624927B93DABB628F265A9E05FB49EA7E7EB7A56988495B681E76E78CBB7FF1283F3AF2803E519385FA56DFC47D60EB7E39D56F54E623398E3039F913E45FD16B0F218673B87B56F15A13213A13C66A362338C7BD3DB9E33DA9B819FA550902FA0A5C6EEBFAD203838F7ED4ADC1E718A40210071E94F0C0819FBBD293041C1CF5EB4678E940112E51F078C1EF528240FA8EB51CBD43631F4A553F2E46314229EBA9206005283920F53EF4809E84014B8C9CE69D8CC5048A77B0A8F9DC0FBD2A9C8A626878E0E0FA77A298067BB51480988049EB4D00138278A0F24F7A00C902980DC051DFD69C3A63AE6932723F99EF4BEDE94098D6008C1A699644FBA723D29C7393D29B2018C633DE82912C73C7230C9D87D0D39F9763B5B154C80DD79E3AD2ACAEA0AE72BE8DCD2B8F97B1789190F8EDD29228C0F9DB209E80F6A8ED64DE4B9CE01EF564124E7FDDA64BD0423B8E38EE3EED35C06E7F1FA53D41000CF4A6C8BCF241FF0066A8420209CF1EDEF448858647E14DE06D50CD95FF0066A5505B9A919D77C13D51B4CF893A726FDB15EEFB397E8E3E5FFC7D52BD57E24EB37173E2492C50B2C364A1157B39214B1FFC797FEF9AF06D26F24D2359B0D56045692CEE63BA44276ABEC7071EDBB6D7B9FC438E0B9BE8757D3E512C1770453A381C142383FF007C6CAC2B2D99BD213C236DF6A6F309079E457A35988EC6D1AE26610AC63258FF0008AE13E1EC22E1FCF43923EF8F5AEE75AD3E4BED31E087FD6291246ADD188EDFE7FD9AC7A1B75B31D61E28B19C9F33CE80676F9922800FE44FEB5CCF8D7C0CB22C9A9F87E2024E5E4B64FBB2772F1FA37B7E5EE938B5B4D3301596FC72C5860007B63B9FE1DBFEF56EF816EA59B4C7494E62593111EE808CE3E80D4E92D19A7F0FDF89E4D6F7C63390D9F62DD2B4EDF5BC2FCC49C7A9ABFF00177C3C34C9D35BB15C5BDD49E5DCA2701643C87C7A1DBFF7D7FBD5E722F48E9C7E35834D3B1DF09A9C6E8EF5B53591739AA17375BF3C573B67A865F6B356BC5893B66A1964322B487919626A686DCAAF3FA55E82D8B1E07356A2B196E668EDED977CAE70A3FCFF000D095C993B173C11A17DBF51FB4CAA5A0B760C33D1DFB7E5F7BFEF9AF59B78BCB5031DBA0EB599E1ED2A1D3AC21B78B1841C9EEC7B9FCEB60F008FD07F535D74E36479756A73C8A77CDC6D181EC2B97F1BEAE342F096A7A88F95A0B6768C9FEF9184FF00C7996B7E67DF2607E18ED5E63FB43DEBDAFC3DF29318BCBC8606E7F840793F9C6B5B44E73E6F5E5BFDA02A42A54650641EA335147D79E07BD4CB93DF15BA258D238EB48EB9191C63DA958630E3F1C0A1B0C323D3B5212000E3A743431380339A418278CE6824103031ED40C5F707F2A01DC473C5229C70738F4A3A9EFC5002483209EFE9EF4C8CF51FAD48DCF4E2A25E1B0287B94B625CF39C52827FFAC29010477CD03B62992193D8F34F180D4CA76723AF6A04C7F4A2900E7919FC28AB2479E3AD03DC507EE9A3B7E352037A0F71EB4B9C139C7269ABF7DA9CDD280109C67005479E78EBDAA53D5AA36FBCBFEED03433191C7E3C53E288CB260E428EA7342F7FC6A7B7FF0053F8FF005A436C5641B540182178C548AE09C0EB520FBA6A27FBEBF5A6412E0E45230C8C1A13FC6A57FBA3F0A60572A777A53D011C134E3F7A99FE148078C9E4F635EC1F0EEF06B1E0D86CE66677B45781CFA0058A0FFBE596BC85FEE9FC2BD03E0E7FC7E6A1F48FF99ACEA2D0D21B9DB7C37BD3A7F898D9CFB9527263E7B1ED5EC6F1A9552475FD2BC3F56FF91AD7FEBA2FF4AF70B5FF008F54FF0074573AD8DA452BAD2ED6EC93716D14CE3A965E7F3A92158ED955208442A39C28C0AB8DFEB47D29971F74FD051B0733667F88F4C875ED02FB4E6D9FE930B460B74493AAB7E0C01AF97C72A0E0A923241AFAA61FBEF5F3878CFF00E46AD5BFEBF25FFD0CD6753B9D786766D1936B9F341CD765A52965420609AE3A1FBC95D7E87FEA52B0676B37EDE1206EAEAFC3B6496160DAADD46EEF292115393B07F563FA62B9E83EEAFD2BB6D3BFE40365FEE37F3AD29EE72E224D46C56D3FC73A1CB742DA6924B0931C7DAC0407FE059C0AE9273FBAC606D23F015E13E2EFF91864FF007C7F215E9FF0F7FE45087E9FD4D6F16704958D4639739E7EB5E21FB4BEA1FBAD134E59012CD35CC8BED84543FAC95EE127FACFCABC13F695FF008FBD0BFDD9FF009A5690DC4BA9E3A87193D6A653F2E09A857A8FA54ABF7AB646721DDB278F7A6ECDDF38FCBD69F27DDFC6957A0FAD04DC809C93814AA09C0F4A597EF9A58FEF8A657418C081C8FC4D3BA818A43D2917EE8FAD0807A9CF079A89C82E360E9E94F6FBA3E95147F7A931C7B929E9D71498C74F5A5FF0A28E82140FD6973B874E685FBBF951FC3F87F5A6214301EDED4525145C563FFFD9'
       )
    }
    else {
        cardReader.readCardFunc = cardReader.GetIDCardInfo;
        cardReader.ReadCard(window, showErr);
        idInfo = cardReader.IDInfo;
        if (idInfo == null) return null;
    }

    SearchCustomerInfo(idInfo, true);
};
String.prototype.Trim = function () {
    return this.replace(/(^\s*)|(\s*$)/g, "");
}
function ReadIDCardEx(nameId, sexId, birthId, paperTypeId, papernoId, addrId) {
    if (cardReader.testingMode) {
        $('#' + nameId).textbox('setValue', 'test');
        $('#' + sexId).textbox('setValue', "0");
        $('#' + birthId).textbox('setValue', "2011-11-11");
        $('#' + paperTypeId).textbox('setValue', '00');
        $('#' + papernoId).textbox('setValue', '111111');
        $('#' + addrId).textbox('setValue', 'add');
        return true;
    }
    //var idInfo = ReadIDCard(nameId, sexId, birthId, paperTypeId, papernoId, addrId);
    //if (idInfo == null) return false;
    cardReader.readCardFunc = cardReader.GetIDCardInfo;
    var idInfo = TargetWindowReadCard();
    if (idInfo == null) return null;

    $('#' + nameId).textbox('setValue', idInfo.name.Trim());
    $('#' + sexId).textbox('setValue', idInfo.birth.Trim());
    $('#' + birthId).textbox('setValue', idInfo.birth.substr(0, 4) + '-' + idInfo.birth.substr(4, 2) + '-' + idInfo.birth.substr(6, 2));
    $('#' + paperTypeId).textbox('setValue', '00');
    $('#' + papernoId).textbox('setValue', idInfo.paperno.Trim());
    $('#' + addrId).textbox('setValue', idInfo.addr.Trim());
    return true;
}

function TargetWindowReadCard(showErr) {
    return cardReader.ReadCard(window, showErr);
}

function ReadCardInfoImpl(cardNoId, func, assignFunc, showErr) {
    var cardInfo = null;
    if (inTestingMode(cardNoId)) {
        var cardNo = $('#' + cardNoId).val();
        cardInfo = new $.wx.ocx.CardInfo(cardNo, "02", "01", "00001122334455661000",
            "20020102", "20500101", "FCI", "01", "2222", 0, "FF", 1000);
        cardReader.CardInfo = cardInfo;

    }
    else {
        cardReader.readCardFunc = func;
        cardReader.ReadCard(window, showErr);
        cardInfo = cardReader.CardInfo;
    }

    if (cardInfo == null) {
        return false;
    }

    if (assignFunc) {
        assignFunc(cardInfo);
    }

    return true;
}

function saleCard() {
    cardReader.cardHolderName = stringToHex($('#hidCustName').val());
    cardReader.cardHolderPaperno = stringToHex($('#hidPaperNo').val());//证件号码转换成16进制
    cardReader.writeCardFunc = new Array(cardReader.startCard, cardReader.ChangeCardHolder);//新增写入持卡人资料 add by youyue
    writeCard();
}

function chargeCard() {
    cardReader.preMoney = parseInt($('#hideMoney').val());
    cardReader.chargeMoney = GetFee("01");
    cardReader.readCallback = function () {
        ReadCard();
        if (cardReader.ErrRet == 0) {
            $.wx.easyui.msg.info('卡号:' + cardReader.CardNo + '<br/><br/>'
			+ '充值前卡内余额:' + (cardReader.preMoney / 100).toFixed(2) + '<br/><br/>'
			+ '充值金额:<span class="red">' + (cardReader.chargeMoney / 100).toFixed(2) + '</span><br/><br/>'
			+ '充值后读出卡内余额: <span class="red">' + (cardReader.CardInfo.balance / 100).toFixed(2) + '</span>',
		    '充值成功');
            var writeSuccess = { TradeID: $('#hideTradeID').val(), CardTradeNo: $('#hideCardTradeNo').val() };
            $.ajax({
                type: "POST",
                url: "/Home/WriteCard",
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify(writeSuccess)
            });
        }
        return false;
    };
    cardReader.writeCardFunc = cardReader.ChargeCard;
    writeCard();
}


function SupplyCheck(txtCardNo, showErr) {
    var chargemoney = 0;
    var ret = ReadCardInfoImpl('CardNo', cardReader.GetCardInfo, false, true);
    if (!ret) {
        return false;
    }
    if (cardReader.CardInfo.cardNo != $('#CardNo').val()) {
        $.wx.easyui.msg.error("读卡器上卡片为:<br>"
            + cardReader.CardInfo.cardNo + "<br>先前读出卡号为: <br>"
            + $('#hideCardNo').val() + '<br>不一致。<br><br> 请重新点击读卡按钮后再充值！', '');
        return false;
    }

    var supplyMoney = GetFee("01");
    // 检测是否卡内余额加上充值金额超过1千元
    if (!checkMaxBalance(supplyMoney)) return false;
    $.wx.easyui.msg.confirm("是否确认充值:" + (supplyMoney / 100).toFixed(2) + '元?', '提示',
        function () { if (SetChargeCardRequest()) SubmitFunc(true); },
        function () { $.messager.progress('close'); });
    return false;
}


function checkMaxBalance(supplyMoney) {
    // 检测是否卡内余额加上充值金额超过1千元
    var chargeMoney = supplyMoney + cardReader.CardInfo.balance;

    if (chargeMoney > 100000) {
        $.wx.easyui.msg.error("卡内余额加上充值金额:<br>"
            + '<span class="red">不能超过1千元。</span>'
            + "<br>充值失败！", '');
        return false;
    }
    return true;
}


function writeCard() {

    if (cardno) {
        if (cardReader.CardInfo.cardNo != cardno) {
            $.wx.easyui.msg.error("读卡器上卡片为:<br>"
            + '<span class="red">' + cardReader.CardInfo.cardNo + '</span>'
            + "<br>先前读出卡号为: <br>"
            + '<span class="red">' + cardno + '</span>'
            + "<br>不一致。<br><br> 请重新确认办理业务的卡片！", '');
            return;
        }
    }
    setTimeout(writeCardDelay, 500);
}

function writeCardDelay() {
    if (!cardReader.testingMode) {
        cardReader.WriteCard(window);
    } else {
        writeCompleteCallBack();
    }
}

function writeCompleteCallBack() {
    if (cardReader.testingMode) {
        if (cardReader.CardNo.substr(0, 1) != '2') {
            $.wx.easyui.info.success('写卡成功');
            WriteCardSuccFunc();
            $.wx.easyui.msg.tip($('#infos').html(), '', 3000);
            return;
        }
        else {
            $.wx.easyui.msg.confirm('是否重新放置好卡片，然后再试？', '写卡失败'
            , function () { writeCard(); return false; }, function () { $.wx.easyui.msg.error('写卡失败'); return false; });
        }

        return;
    }
    if (cardReader.ErrRet != 0) {
        $.wx.easyui.msg.confirm(cardReader.ErrInfo + ", ReturnCode:" + cardReader.ErrRet +
            '<br><br>是否重新放置好卡片，然后再试？', '写卡失败', function () { writeCard(); return false; },
            function () { $.wx.easyui.msg.error('写卡失败'); return false; });
    }
    else {
        var callCb = true;
        if (cardReader.readCallback) {
            callCb = cardReader.readCallback();
            cardReader.readCallback = null;
        }

        if (callCb) {
            $.wx.easyui.info.success('写卡成功');

            $.wx.easyui.msg.tip($('#infos').html(), '', 3000);
        }
        WriteCardSuccFunc();
    }
}

function inTestingMode(cardNoId) {
    if (!cardReader.testingMode) {
        return false;
    }

    var id = $('#' + cardNoId);

    if (cardReader.testingMode && id != null) {
        cardReader.CardNo = $('#' + cardNoId).val();
    }

    return cardReader.testingMode;
}
function checkCardNo(cardNoId) {
    if (!cardReader.testingMode) {
        return true;
    }
    var cardno = $('#' + cardNoId).val();
    if (cardReader.CardNo != cardno) {
        return false;
    }
    return true;
}


function lockCard() {
    cardReader.writeCardFunc = cardReader.lockCard;
    writeCard();
}

function unlockCard() {
    cardReader.writeCardFunc = cardReader.unlockCard;
    writeCard();
}

function unchargeCard() { unchargeCardImpl(cardReader.unchargeCard); }

function unchargeCardImpl(func) {
    cardReader.preMoney = parseInt($('#hiddencMoney').val());
    cardReader.chargeMoney = parseInt($('#hidUnSupplyMoney').val());
    cardReader.writeCardFunc = func;
    writeCard();
}

function changeCard() {
    cardReader.preMoney = parseInt($('#hiddencMoney').val());
    cardReader.chargeMoney = parseInt($('#hidSupplyMoney').val());
    cardReader.cardHolderName = stringToHex($('#hidCustName').val());
    cardReader.cardHolderPaperno = stringToHex($('#hidPaperNo').val());//证件号码转换成16进制
    cardReader.writeCardFunc = new Array(cardReader.ChargeCard,cardReader.ChangeCardHolder);//新增写入持卡人资料 add by youyue

    writeCard();
}
//add by chenchu
function makeUpCard() {
    cardReader.cardHolderName = stringToHex($('#hidCustName').val());
    cardReader.cardHolderPaperno = stringToHex($('#hidPaperNo').val());
    cardReader.writeCardFunc = new Array(cardReader.startCard, cardReader.ChangeCardHolder);
    writeCard();
}
function transitBalance() {
    cardReader.preMoney = parseInt($('#hiddencMoney').val());
    cardReader.chargeMoney = parseInt($('#hidSupplyMoney').val());

    cardReader.writeCardFunc = cardReader.ChargeCard;

    writeCard();
}

function changeCardRollback() {
    cardReader.preMoney = parseInt($('#hiddencMoney').val());
    cardReader.chargeMoney = parseInt($('#hidSupplyMoney').val())

    cardReader.writeCardFunc = cardReader.unchargeCard;

    writeCard();
}

showReadCardErr = function (errInfo, errRet, showErr) {
    if (showErr) {
        $.wx.easyui.msg.error('错误码:' + errRet + ', 读卡错误:' + errInfo, '读卡错误');
    }
}

function ReadCardRecord(showErr) {
    var record = null;
    if (inTestingMode('CardNo')) {
        record = new $.wx.ocx.CardRecord('0000000000000000000000000000000000000000',
        '00000000000000000000000000000000000000000000000000000000000000000000000000000000',
        '00000000000000000000',
        '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
        '00000000000000000000000000000000000000000000000000000000000000000000000000000000',
        '000000000000000000000000000000000000000000000000000000000000'
        );
    }
    else {
        cardReader.readCardFunc = cardReader.GetRecords;
        cardReader.ReadCard(window, showErr);
        record = cardReader.CardRecord;
        if (record == null) return false;
    }
    $('#hidTradeno').val(record.tradeNo);
    $('#hidTradeMoney').val(record.tradeMoney);
    $('#hidTradeType').val(record.tradeType);
    $('#hidTradeTerm').val(record.tradeTerm);
    $('#hidTradeDate').val(record.tradeDate);
    $('#hidTradeTime').val(record.tradeTime);
}

function OpenMonthlyCard() {
    //如果是老年优惠卡或政府乘车卡，自动激活卡
    //做一笔0元消费操作，激活老年免费卡
    cardReader.preMoney = cardReader.CardInfo.balance;
    cardReader.chargeMoney = 0;
    cardReader.monthlyInfo = $('#hidMonthlyFlag').val();
    cardReader.endDate = $('#hidVerifyDate').val();
    var writeCardFunc = $('#hidWriteCardFunc').val();
    if (writeCardFunc != '') {
        cardReader.writeCardFunc = new Array(cardReader.WriteMonthlyInfo, cardReader[writeCardFunc]);
    }
    else {
        cardReader.writeCardFunc = cardReader.WriteMonthlyInfo;
    }
    writeCard();
}

function CloseMonthlyCard() {
    cardReader.monthlyInfo = "0101";
    cardReader.writeCardFunc = cardReader.WriteMonthlyInfo;
    writeCard();
}

function readDriverInfo(staffCtlId, cardNoId, taxiNoId, stateId, useTag) {
    if (inTestingMode(staffCtlId)) {
        return true;
    }
    return $.wx.ocx.readDriverInfoImpl(staffCtlId, cardNoId, taxiNoId, stateId, useTag) != null;
}

//退卡后，除了锁卡，还要将卡内余额圈提
function lockAndWriteCard(preMoneyId) {
    cardReader.preMoney = $('#' + preMoneyId).val();
    cardReader.chargeMoney = cardReader.preMoney;
    cardReader.writeCardFunc = new Array(cardReader.unchargeCard, cardReader.lockCard);
    writeCard(); 
}

//退卡返销后，除了解锁卡，同时要将卡内余额圈存回去
function unlockAndWriteCard(quancunMoneyId) {
    var quancunMoney = $("#" + quancunMoneyId).val();
    cardReader.preMoney = 0;
    cardReader.chargeMoney = quancunMoney;
    cardReader.writeCardFunc = cardReader.unlockCard;//解锁
    if (quancunMoney > 0) {
        //需要圈存
        cardReader.writeCardFunc = new Array(cardReader.unlockCard, cardReader.ChargeCard);//先解锁才能圈存
    }
    writeCard();  
}
//字符串转换为16进制，例如字符‘12’转换成十六进制为‘0x31,0x32’  add by youyue
function stringToHex(str) {
    var val = "";
    for (var i = 0; i < str.length; i++) {
        if (val == "")
            val = str.charCodeAt(i).toString(16);
        else
            val += str.charCodeAt(i).toString(16);
    }
    return val;
}
//16进制转换为字符串  add by youyue
function hexToString(str){
    var val="";
    var arr = str.split(",");
    for(var  i = 0; i < arr.length; i++){
        val += String.fromCharCode(arr[i].toString());
    }
    return val;
}
//读取旧卡卡号
function ReadOldCard() {
    var ret = ReadCardInfoImpl('txtSearchOldCardNo', cardReader.GetCardInfo, false, true);
    if (!ret) {
        return false;
    }
    $('#txtSearchOldCardNo').val(cardReader.CardInfo.cardNo);
    return true;
 }



